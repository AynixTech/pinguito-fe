<div class="campaigns-container">
  <div class="header">
    <h1>
      <i class="fas fa-envelope-open-text"></i>
      Campagne Email
    </h1>
    <button class="btn btn-primary" routerLink="/dashboard/email-campaigns/create">
      <i class="fas fa-plus"></i>
      Nuova Campagna
    </button>
  </div>

  <div class="filters">
    <div class="search-box">
      <i class="fas fa-search"></i>
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        (input)="filterCampaigns()"
        placeholder="Cerca per nome o oggetto...">
    </div>

    <select [(ngModel)]="statusFilter" (change)="filterCampaigns()" class="status-filter">
      <option value="">Tutti gli stati</option>
      <option value="draft">Bozze</option>
      <option value="scheduled">Programmate</option>
      <option value="sending">In invio</option>
      <option value="sent">Inviate</option>
      <option value="failed">Fallite</option>
    </select>
  </div>

  <div class="campaigns-table">
    <table>
      <thead>
        <tr>
          <th>Nome Campagna</th>
          <th>Oggetto</th>
          <th>Destinatari</th>
          <th>Stato</th>
          <th>Statistiche</th>
          <th>Data</th>
          <th>Azioni</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let campaign of filteredCampaigns">
          <td><strong>{{ campaign.name }}</strong></td>
          <td>{{ campaign.subject }}</td>
          <td>{{ campaign.recipientCount || 0 }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(campaign.status)">
              {{ getStatusLabel(campaign.status) }}
            </span>
          </td>
          <td>
            <div class="stats" *ngIf="campaign.status === 'sent'">
              <span title="Inviati">üìß {{ campaign.sentCount || 0 }}</span>
              <span title="Aperti">üëÅ {{ campaign.openedCount || 0 }}</span>
              <span title="Click">üñ± {{ campaign.clickedCount || 0 }}</span>
            </div>
            <span *ngIf="campaign.status !== 'sent'">-</span>
          </td>
          <td>{{ (campaign.sentAt || campaign.createdAt) | date: 'dd/MM/yyyy HH:mm' }}</td>
          <td>
            <div class="actions">
              <button 
                *ngIf="campaign.status === 'draft'" 
                class="btn-icon btn-send"
                (click)="sendCampaign(campaign.uuid!)"
                title="Invia">
                <i class="fas fa-paper-plane"></i>
              </button>
              <button 
                class="btn-icon btn-delete"
                (click)="deleteCampaign(campaign.uuid!)"
                title="Elimina">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="filteredCampaigns.length === 0" class="empty-state">
      <i class="fas fa-envelope"></i>
      <p>Nessuna campagna trovata</p>
      <button class="btn btn-primary" routerLink="/dashboard/email-campaigns/create">
        Crea la tua prima campagna
      </button>
    </div>
  </div>
</div>
